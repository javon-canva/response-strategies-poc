# SentinelOne Malware Detection Incident Playbook

## Overview

**Incident Type:** Malware Detection  
**Severity Levels:** Low/Medium/High/Critical  
**Response Team:** Detection & Response Team  
**Version:** 1.0  
**Last Updated:** 2025-07-25  
**Maintainer:** Detection & Response Team

## Detection Sources

- [SentinelOne Management Console](https://usea1-ms.sentinelone.net/)
- [Endpoint Detection Rules](https://community.sentinelone.com/s/article/Sentinelone-Admin-Guide)
- [Previous Response Examples](https://pew-pew.canva-internal.com)

## Response Strategy

### Assumptions

- Access to the SentinelOne Management Console with appropriate permissions
- Familiarity with basic endpoint security concepts
- Authorization to take containment actions on endpoints
- Understanding of malware types and behavior patterns

### Considerations

- Isolating an endpoint will impact the user's ability to work
- Critical production systems require coordination with system owners before taking containment actions
- Alert severity in SentinelOne correlates with recommended response urgency
- False positives may occur, particularly for developer machines with security testing tools
- Some remediation actions may result in data loss or service interruption

## Triage

### Initial Assessment

1. Access the SentinelOne Management Console:
   - Log into the [SentinelOne Management Console](https://usea1-ms.sentinelone.net/)
   - Navigate to the "Incidents" section
   - Locate the specific alert in question
   - Review the alert timestamp and detection time

2. Evaluate Alert Context:
   - Examine the alert severity (Critical, High, Moderate, Low)
   - Review the detection engine that triggered the alert (Static AI, Behavioral AI, Reputation)
   - Check the alert classification (Malware, Suspicious Activity, PUA)
   - Note any automatic actions already taken by SentinelOne

3. Investigate Affected Endpoint:
   - Check the endpoint's current status (Online/Offline)
   - Review the endpoint metadata (OS, IP address, last seen time)
   - Identify the endpoint owner and business function
   - Determine if the endpoint is a production system or user workstation

4. Analyze Detected Threat:
   - Review the process tree to understand execution flow
   - Check file details (path, hash values, size)
   - Examine network connections initiated by the process
   - Identify any persistence mechanisms established
   - Check if the threat attempted to access sensitive files or make system changes

### Severity Assessment Criteria

| Severity | Criteria |
|----------|----------|
| Critical | Confirmed ransomware or data destructive malware; Active exploitation of zero-day vulnerability; Multiple endpoint infections showing lateral movement; Malware in critical production environment; Threat targeting sensitive data with evidence of exfiltration | 
| High     | Confirmed malware on business-critical system; Multiple endpoint infections; Backdoor or remote access trojan detected; Evidence of deliberate targeting; Threat with data exfiltration capability |
| Medium   | Confirmed malware on single non-critical endpoint; Known commodity malware with containment in place; PUA on sensitive system; Suspicious activity without confirmation of malice |
| Low      | Potentially Unwanted Application (PUA) on non-critical system; Low-risk adware; Isolated suspicious activity with no evidence of execution; Known false positive patterns |

### Validation Criteria

Escalate to an incident if any of the following are true:
- Critical or High severity malware is confirmed
- Multiple endpoints are affected by the same threat
- The affected system contains or has access to sensitive data
- There is evidence of deliberate targeting or data exfiltration
- The threat demonstrates novel techniques or is not recognized by reputation services
- The threat has established persistence mechanisms

## Investigation

### Investigation Pattern

Follow the [Endpoint Malware Investigation Pattern](../../investigation-patterns/endpoint-malware-investigation.md) for this incident type.

### Data Sources

Use these data source procedures to gather evidence:
- [SentinelOne Deep Visibility](../../data-source-procedures/sentinelone-deep-visibility.md)
- [Endpoint Forensic Analysis](../../data-source-procedures/endpoint-forensic-analysis.md)

### Investigation Steps

1. **Analyze Process Execution Chain**
   - Examine the full process tree to understand how the malware was executed
   - Identify the parent processes and child processes
   - Review command line arguments for suspicious patterns
   - Look for evidence of privilege escalation or defense evasion
   - Expected outcome: Complete understanding of malware execution flow

2. **Assess Malware Capabilities**
   - Analyze network connections to identify command and control channels
   - Review file operations to detect data access or exfiltration attempts
   - Check for evidence of lateral movement or credential harvesting
   - Examine registry modifications for persistence mechanisms
   - Expected outcome: Determination of malware capabilities and impact

3. **Determine Infection Vector**
   - Identify how the malware entered the environment
   - Check recent email attachments, downloads, or application installations
   - Look for evidence of exploitation of known vulnerabilities
   - Determine if removable media was involved
   - Expected outcome: Identification of the initial infection vector

4. **Evaluate Scope of Compromise**
   - Search for the same indicators of compromise across other endpoints
   - Check for lateral movement attempts to other systems
   - Review authentication logs for suspicious access
   - Determine if sensitive data was accessed or exfiltrated
   - Expected outcome: Complete assessment of the compromise scope

## Containment

### Containment Strategy

Isolate affected endpoints to prevent lateral movement while preserving evidence for investigation.

### Containment Steps

1. **Endpoint Isolation**
   - For confirmed threats, isolate the endpoint using SentinelOne's "Network Isolation" feature
   - Select the appropriate isolation level (Full, Selective) based on severity
   - Document the time of isolation and the console user who performed the action
   - Inform the affected user through appropriate communication channels
   - Expected outcome: Endpoint is isolated from the network but remains available for investigation

2. **Process Termination**
   - For active threats, use the "Kill Process" action to terminate malicious processes
   - Identify and terminate any related child processes
   - Document all terminated processes and their relationships
   - Expected outcome: Malicious processes are stopped from continuing execution

3. **Stakeholder Notification**
   - For user endpoints: Contact the affected user through Slack to explain the situation
   - For production systems: Alert the relevant team through the appropriate Slack channel
   - Use standardized templates for communication to ensure consistency
   - Include expected duration of containment and next steps
   - Expected outcome: All stakeholders are informed with appropriate context

## Eradication

### Eradication Strategy

Remove malware from affected systems while minimizing impact to business operations.

### Eradication Steps

1. **Threat Mitigation**
   - Use SentinelOne's "Remediate" option for confirmed malware
   - Select appropriate remediation actions (Quarantine, Delete, Rollback)
   - For potentially unwanted applications (PUAs), consult with the user before removal
   - Document all remediation actions taken
   - Expected outcome: Malware is effectively removed from the system

2. **Extended Cleaning**
   - Run additional scans to identify any remaining traces of infection
   - Check for persistence mechanisms that may have been established
   - Remove any malicious registry entries, scheduled tasks, or startup items
   - Verify removal of all identified indicators of compromise
   - Expected outcome: All components of the threat are removed

3. **Vulnerability Mitigation**
   - Identify and address any vulnerabilities that enabled the infection
   - Apply necessary patches or configuration changes
   - Implement any required security controls to prevent reinfection
   - Document all mitigations applied
   - Expected outcome: Attack vector is secured against similar threats

## Recovery

### Recovery Strategy

Restore system functionality while ensuring enhanced security posture against future attacks.

### Recovery Steps

1. **Endpoint Restoration**
   - After confirming threat removal, remove network isolation
   - Verify endpoint functionality with the user
   - Monitor the endpoint for 24-48 hours for any recurring issues
   - Expected outcome: System is returned to normal operations

2. **System Verification**
   - Run a full system scan to ensure complete remediation
   - Verify that critical services and applications are functioning
   - Check for any persistent changes that might require additional remediation
   - Expected outcome: Confirmation that the system is clean and operational

3. **Security Posture Improvement**
   - Implement additional security controls if needed
   - Update endpoint security policies based on lessons learned
   - Provide user education if the infection resulted from user action
   - Expected outcome: Improved security posture to prevent similar incidents

## Post-Incident Activities

### Lessons Learned

Reference the [Post-Incident Review Process](../../sops/post-incident-review-sop.md) for conducting a comprehensive review.

### Key Metrics to Collect

- Time to detection from initial infection
- Time to containment after detection
- Number of affected endpoints
- Type of malware involved
- Initial infection vector
- Effectiveness of security controls

### Detection Improvement

- Update SentinelOne policies based on findings
- Create custom detection rules for similar threats
- Improve alerting for similar attack patterns
- Share threat intelligence with security community

## Additional Resources

- [SentinelOne Admin Guide](https://community.sentinelone.com/s/article/Sentinelone-Admin-Guide)
- [SentinelOne Threat Hunting Guide](https://community.sentinelone.com/s/article/Threat-Hunting-Guide)
- [Generic IR SOPs](https://canvadev.atlassian.net/wiki/spaces/CDR/pages/2855797478/Standard+Operating+Procedures)
- [Canva Endpoint Investigation SOP](https://canvadev.atlassian.net/wiki/spaces/CDR/pages/endpoint-investigation)

## Related Artifacts

- [Malware Analysis Guidelines](../../artifact-guidelines/malware-analysis-guidelines.md)
- [Endpoint Security Configuration Standards](../../artifact-guidelines/endpoint-security-standards.md)
- [Malware Response Checklist](../../artifact-guidelines/malware-response-checklist.md)